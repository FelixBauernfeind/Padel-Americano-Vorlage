<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Americano Vorlage â€“ Padelzone</title>

<style>
* { box-sizing: border-box; }

body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI";
  background:#f5f5f7;
  margin:0;
  font-size:16px;
}

/* ===== HEADER ===== */
.header {
  background:#f59e0b;
  padding:16px 22px;
}
.header h1 {
  margin:0;
  font-size:28px;
  color:white;
}
.header p {
  margin:6px 0 0;
  font-size:16px;
  color:white;
  opacity:.95;
}

/* ===== CONTENT ===== */
.content {
  padding:22px;
  max-width:1200px;
  margin:auto;
}

.section {
  background:white;
  border-radius:16px;
  padding:20px;
  margin-bottom:24px;
}

label {
  display:block;
  margin-bottom:10px;
  font-weight:500;
}

/* ===== INPUTS ===== */
input {
  width:100%;
  padding:12px;
  font-size:16px;
  border-radius:10px;
  border:1px solid #ccc;
}

/* ===== COUNT + TRASH ===== */
.count-row {
  display:flex;
  align-items:center;
  gap:12px;
  margin-bottom:26px;
}

#count {
  max-width:90px;
}

.trash {
  width:44px;
  height:44px;
  border-radius:12px;
  border:1px solid #ddd;
  background:#f5f5f7;
  font-size:20px;
  cursor:pointer;
}
.trash:hover {
  background:#ffe4e4;
  border-color:#ffb3b3;
}

/* ===== BUTTONS ===== */
button.primary {
  width:100%;
  padding:14px;
  font-size:17px;
  background:#1d1d1f;
  color:white;
  border:none;
  border-radius:12px;
  margin-top:16px;
  cursor:pointer;
}

/* ===== PLAYER GRID ===== */
.grid {
  display:grid;
  grid-template-columns:repeat(2,minmax(0,1fr));
  gap:12px;
}

/* ===== MATCHES ===== */
.match {
  display:grid;
  grid-template-columns:1fr 56px 24px 56px 1fr;
  align-items:center;
  text-align:center;
  gap:10px;
  margin-top:14px;
}

.team { font-weight:500; }

.pause {
  margin-top:12px;
  font-size:15px;
  font-style:italic;
  color:#666;
}

/* ===== TABLE ===== */
table {
  width:100%;
  border-collapse:collapse;
}
th, td {
  padding:10px;
  border-bottom:1px solid #ddd;
  text-align:left;
}

/* ===== MOBILE ===== */
@media (max-width:600px){
  body { font-size:17px; }
  input { font-size:17px; }
  button.primary { font-size:18px; padding:16px; }
}
</style>
</head>

<body>

<div class="header">
  <h1>Americano Vorlage</h1>
  <p>Padelzone â€“ Felix Nikolas Bauernfeind</p>
</div>

<div class="content">

  <div class="section">
    <label>Anzahl Spieler</label>

    <div class="count-row">
      <input type="number" id="count" min="4">
      <div style="flex:1"></div>
      <button class="trash" onclick="resetTournament()">ðŸ—‘</button>
    </div>

    <div class="grid" id="players"></div>

    <button class="primary" onclick="createPlan()">Spielplan erstellen</button>
  </div>

  <div id="plan"></div>

  <div class="section">
    <button class="primary" onclick="calculate()">ðŸ”¢ Ergebnisse berechnen</button>
  </div>

  <div class="section">
    <h2>Rangliste</h2>
    <table id="ranking"></table>
  </div>

</div>

<script>
const count = document.getElementById("count");
const players = document.getElementById("players");
const plan = document.getElementById("plan");
const ranking = document.getElementById("ranking");

let playerNames = [];
let stats = {};
let scoreInputs = {};

/* ===== PLAYERS ===== */
function renderPlayers() {
  players.innerHTML = "";
  const c = parseInt(count.value) || 8;

  for (let i = 0; i < c; i++) {
    const val = playerNames[i] || "";
    playerNames[i] = val;
    players.innerHTML += `
      <input value="${val}" placeholder="Spieler ${i+1}"
        oninput="playerNames[${i}]=this.value">
    `;
  }
}

count.onchange = renderPlayers;

/* ===== RESET ===== */
function resetTournament() {
  if (!confirm("Neues Turnier starten?")) return;
  plan.innerHTML = "";
  ranking.innerHTML = "";
  playerNames = [];
  stats = {};
  count.value = 8;
  renderPlayers();
}

/* ===== PLAN ===== */
function createPlan() {
  plan.innerHTML = "";
  stats = {};

  const list = playerNames.filter(n => n.trim());
  const n = list.length;
  if (n < 4) return;

  list.forEach(p => stats[p] = { points:0, games:0 });

  if (n % 4 === 0) return perfectAmericano(list);
  if (n % 4 === 1) return singlePauseAmericano(list);
  fairApproxAmericano(list);
}

/* ===== PERFECT ===== */
function perfectAmericano(players) {
  let rot = [...players];
  for (let r = 0; r < players.length - 1; r++) {
    const sec = section(`Runde ${r+1}`);
    for (let i = 0; i < rot.length; i += 4)
      match(sec,r,i/4,[rot[i],rot[i+1]],[rot[i+2],rot[i+3]]);
    plan.appendChild(sec);
    rot = [rot[0], ...rot.slice(1).slice(-1), ...rot.slice(1,-1)];
  }
}

/* ===== ONE PAUSE ===== */
function singlePauseAmericano(players) {
  let rot = [...players];
  for (let r = 0; r < players.length; r++) {
    const sec = section(`Runde ${r+1}`);
    const pause = rot[0];
    const act = rot.slice(1);
    for (let i = 0; i < act.length; i += 4)
      match(sec,r,i/4,[act[i],act[i+1]],[act[i+2],act[i+3]]);
    pauseLine(sec,[pause]);
    plan.appendChild(sec);
    rot.push(rot.shift());
  }
}

/* ===== FAIR APPROX ===== */
function fairApproxAmericano(players) {
  let rot = [...players];
  for (let r = 0; r < players.length; r++) {
    const sec = section(`Runde ${r+1}`);
    const play = Math.floor(rot.length/4)*4;
    const act = rot.slice(0,play);
    const pause = rot.slice(play);
    act.sort(()=>Math.random()-0.5);
    for (let i = 0; i < act.length; i += 4)
      match(sec,r,i/4,[act[i],act[i+1]],[act[i+2],act[i+3]]);
    pauseLine(sec,pause);
    plan.appendChild(sec);
    rot.push(rot.shift());
  }
}

/* ===== UI HELPERS ===== */
function section(t){
  const d=document.createElement("div");
  d.className="section";
  d.innerHTML=`<strong>${t}</strong>`;
  return d;
}

function match(r,rn,m,A,B){
  const d=document.createElement("div");
  d.className="match";
  d.dataset.teamA=A.join("|");
  d.dataset.teamB=B.join("|");
  d.innerHTML=`
    <div class="team">${A.join(" & ")}</div>
    <input class="score" type="number">
    <div>:</div>
    <input class="score" type="number">
    <div class="team">${B.join(" & ")}</div>`;
  r.appendChild(d);
}

function pauseLine(r,p){
  if(!p.length)return;
  const d=document.createElement("div");
  d.className="pause";
  d.textContent=`Pause: ${p.join(", ")}`;
  r.appendChild(d);
}

/* ===== CALC ===== */
function calculate(){
  Object.values(stats).forEach(s=>{s.points=0;s.games=0});
  document.querySelectorAll(".match").forEach(m=>{
    const A=m.dataset.teamA.split("|");
    const B=m.dataset.teamB.split("|");
    const s=m.querySelectorAll("input");
    const a=parseInt(s[0].value);
    const b=parseInt(s[1].value);
    if(!isNaN(a))A.forEach(p=>{stats[p].points+=a;stats[p].games++});
    if(!isNaN(b))B.forEach(p=>{stats[p].points+=b;stats[p].games++});
  });
  updateRanking();
}

function updateRanking(){
  const rows=Object.entries(stats).map(([n,s])=>({...s,name:n,ppg:(s.games?s.points/s.games:0).toFixed(2)}));
  rows.sort((a,b)=>b.ppg-a.ppg);
  ranking.innerHTML=`<tr><th>Spieler</th><th>Spiele</th><th>Punkte</th><th>Punkte/Spiel</th></tr>`;
  rows.forEach(r=>ranking.innerHTML+=`
    <tr><td>${r.name}</td><td>${r.games}</td><td>${r.points}</td><td>${r.ppg}</td></tr>`);
}

/* INIT */
count.value=8;
renderPlayers();
</script>

</body>
</html>
