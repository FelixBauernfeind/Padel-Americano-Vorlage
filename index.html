<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Americano Vorlage â€“ Padelzone</title>

<style>
* { box-sizing: border-box; }

body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI";
  background:#f5f5f7;
  margin:0;
  padding:0;
  font-size:16px; /* ðŸ”¤ grÃ¶ÃŸer fÃ¼r Mac */
}

/* ===== HEADER ===== */
.header {
  background:#f59e0b;
  padding:16px 22px;
}
.header h1 {
  margin:0;
  font-size:28px;
  font-weight:600;
  color:white;
}
.header p {
  margin:6px 0 0 0;
  font-size:16px;
  color:white;
  opacity:0.95;
}

/* ===== CONTENT ===== */
.content {
  padding:22px;
  max-width:1200px;
  margin:0 auto;
}

.section {
  background:white;
  border-radius:16px;
  padding:20px;
  margin-bottom:24px;
}

label {
  display:block;
  margin-bottom:10px;
  font-weight:500;
}

/* ===== INPUTS ===== */
input {
  width:100%;
  padding:12px;
  font-size:16px;
  border-radius:10px;
  border:1px solid #ccc;
}

#count {
  max-width:90px;
  margin-bottom:26px;
}

/* ===== BUTTONS ===== */
button {
  width:100%;
  padding:14px;
  font-size:17px;
  background:#1d1d1f;
  color:white;
  border:none;
  border-radius:12px;
  margin-top:16px;
  cursor:pointer;
}

/* ===== PLAYER GRID ===== */
.grid {
  display:grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap:12px;
}

/* ===== ROUNDS ===== */
.round { margin-bottom:28px; }

.match {
  display:grid;
  grid-template-columns: 1fr 56px 24px 56px 1fr;
  align-items:center;
  text-align:center;
  gap:10px;
  margin-top:14px;
}

.team { font-weight:500; }
.score { text-align:center; }

.pause {
  margin-top:12px;
  font-size:15px;
  font-style:italic;
  color:#666;
}

/* ===== TABLE ===== */
table {
  width:100%;
  border-collapse:collapse;
  font-size:15px;
}

th, td {
  padding:10px;
  border-bottom:1px solid #ddd;
  text-align:left;
}

/* ===== MOBILE ===== */
@media (max-width: 600px) {
  body {
    font-size:17px;
  }

  .content {
    padding:16px;
  }

  .section {
    padding:16px;
  }

  input {
    font-size:17px;
  }

  button {
    font-size:18px;
    padding:16px;
  }

  .match {
    font-size:16px;
  }

  table {
    font-size:16px;
  }
}
</style>
</head>

<body>

<div class="header">
  <h1>Americano Vorlage</h1>
  <p>Padelzone â€“ Felix Nikolas Bauernfeind</p>
</div>

<div class="content">

  <div class="section">
    <label>Anzahl Spieler</label>
    <input type="number" id="count" value="8" min="4">

    <div class="grid" id="players"></div>

    <button onclick="createPlan()">Spielplan erstellen</button>
  </div>

  <div id="plan"></div>

  <div class="section">
    <button onclick="calculate()">ðŸ”¢ Ergebnisse berechnen</button>
  </div>

  <div class="section">
    <h2>Rangliste</h2>
    <table id="ranking"></table>
  </div>

</div>

<script>
let stats = {}; // { name: { points, games } }

/* ===== SPIELERFELDER ===== */
function renderPlayers() {
  const div = document.getElementById("players");
  div.innerHTML = "";
  const count = parseInt(document.getElementById("count").value);
  for (let i = 1; i <= count; i++) {
    div.innerHTML += `<input id="p${i}" placeholder="Spieler ${i}">`;
  }
}
count.onchange = renderPlayers;
renderPlayers();

/* ===== SPIELPLAN ===== */
function createPlan() {
  plan.innerHTML = "";
  stats = {};

  const count = parseInt(document.getElementById("count").value);
  const players = [];

  for (let i = 1; i <= count; i++) {
    const name = document.getElementById("p" + i).value.trim();
    if (name) {
      players.push(name);
      stats[name] = { points: 0, games: 0 };
    }
  }

  const rounds = players.length - 1;
  let rotation = [...players];

  for (let r = 0; r < rounds; r++) {
    const round = document.createElement("div");
    round.className = "section round";
    round.innerHTML = `<strong>Runde ${r + 1}</strong>`;

    let active = [...rotation];
    const pause = [];

    while (active.length % 4 !== 0) {
      pause.push(active.pop());
    }

    for (let i = 0; i < active.length; i += 4) {
      const teamA = [active[i], active[i + 1]];
      const teamB = [active[i + 2], active[i + 3]];

      const match = document.createElement("div");
      match.className = "match";
      match.dataset.teamA = teamA.join("|");
      match.dataset.teamB = teamB.join("|");

      match.innerHTML = `
        <div class="team">${teamA.join(" & ")}</div>
        <input type="number" class="score scoreA">
        <div>:</div>
        <input type="number" class="score scoreB">
        <div class="team">${teamB.join(" & ")}</div>
      `;

      round.appendChild(match);
    }

    if (pause.length) {
      const p = document.createElement("div");
      p.className = "pause";
      p.textContent = `Pause: ${pause.join(", ")}`;
      round.appendChild(p);
    }

    plan.appendChild(round);
    rotation.splice(1, 0, rotation.pop());
  }

  updateRanking();
}

/* ===== AUSWERTUNG ===== */
function calculate() {
  Object.values(stats).forEach(s => {
    s.points = 0;
    s.games = 0;
  });

  document.querySelectorAll(".match").forEach(match => {
    const A = match.dataset.teamA.split("|");
    const B = match.dataset.teamB.split("|");

    const a = parseInt(match.querySelector(".scoreA").value);
    const b = parseInt(match.querySelector(".scoreB").value);

    if (!isNaN(a)) {
      A.forEach(p => {
        stats[p].points += a;
        stats[p].games += 1;
      });
    }

    if (!isNaN(b)) {
      B.forEach(p => {
        stats[p].points += b;
        stats[p].games += 1;
      });
    }
  });

  updateRanking();
}

function updateRanking() {
  const table = document.getElementById("ranking");

  const rows = Object.entries(stats).map(([name, s]) => ({
    name,
    games: s.games,
    points: s.points,
    ppg: s.games ? (s.points / s.games).toFixed(2) : "0.00"
  }));

  rows.sort((a, b) => 
    b.ppg - a.ppg || b.points - a.points || a.name.localeCompare(b.name)
  );

  table.innerHTML = `
    <tr>
      <th>Spieler</th>
      <th>Spiele</th>
      <th>Punkte</th>
      <th>Punkte / Spiel</th>
    </tr>
  `;

  rows.forEach(r => {
    table.innerHTML += `
      <tr>
        <td>${r.name}</td>
        <td>${r.games}</td>
        <td>${r.points}</td>
        <td>${r.ppg}</td>
      </tr>
    `;
  });
}
</script>

</body>
</html>
